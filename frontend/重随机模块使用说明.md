# 重随机模块使用说明

## 功能概述

重随机模块基于SeedFinder算法，通过多次随机分组来找到最佳的随机种子，最小化多指标间的组间不平衡。现在支持三种不同的指标类型，每种类型使用相应的统计检验方法。

## 支持的指标类型

### 1. 均值 (Mean)
- **适用场景**: 连续型数值指标
- **检验方法**: Welch's t-test
- **示例指标**: GMV、订单金额、用户时长、页面停留时间
- **特点**: 适用于正态分布的连续数据

### 2. 比例 (Proportion)
- **适用场景**: 二值型指标（0/1）
- **检验方法**: Z检验（比例检验）
- **示例指标**: 转化率、留存率、点击率、购买率
- **特点**: 适用于二分类数据，如是否转化、是否留存等

### 3. 比率 (Ratio)
- **适用场景**: 需要计算比率的指标
- **检验方法**: 比率检验（Delta方法）
- **示例指标**: ARPU、客单价、人均订单数、平均订单金额
- **特点**: 需要选择分子和分母列，使用Delta方法进行统计推断

## 使用步骤

### 1. 数据准备
- 上传CSV格式的数据文件
- 确保包含用户ID列和指标列
- 数据应为数值型，比例指标应为0-1之间的值

### 2. 配置参数
- **用户ID列**: 选择包含用户唯一标识的列
- **指标配置**: 
  - 选择要调平的指标列
  - 为每个指标选择合适的类型
  - 系统会自动显示对应的检验方法
- **组别配置**: 设置对照组和实验组的比例
- **迭代次数**: 设置重随机算法的迭代次数（建议100-1000）

### 3. 运行重随机
- 点击"开始重随机"按钮
- 系统会显示进度条
- 算法会尝试多个随机种子，找到最佳的一个

### 4. 查看结果
- **最佳种子**: 显示找到的最佳随机种子
- **候选种子**: 显示前10个最佳候选种子
- **T统计量分布**: 可视化展示所有种子的T统计量分布
- **调平结果**: 显示最佳种子下各指标的显著性检验结果

## 结果解读

### 最佳种子
- 这是算法找到的能够最小化组间不平衡的随机种子
- 使用这个种子进行分组，可以最大程度保证实验的公平性

### T统计量
- T统计量越小，说明组间差异越小
- 最佳种子对应的是所有种子中T统计量最小的一个

### 显著性检验结果
- 显示每个指标在最佳种子下的组间差异检验
- 包括统计量、P值、组均值、样本量等信息
- 如果P值 < 0.05，说明存在显著差异

## 数据格式要求

### CSV文件格式
```csv
user_id,group_name,gmv,conversion_rate,arpu
user_001,control_group,1250.50,0.15,45.20
user_002,treatment_group,1380.75,0.18,52.30
```

### 列名要求
- **用户ID列**: 包含用户唯一标识
- **指标列**: 数值型数据
- **分组列**: 可选，如果存在会被忽略（重随机会重新分配）

### 数据类型
- **均值指标**: 连续数值，如1250.50
- **比例指标**: 0-1之间的数值，如0.15
- **比率指标**: 正数值，如45.20

## 最佳实践

### 1. 指标选择
- 选择业务核心指标进行调平
- 建议选择3-5个重要指标
- 确保指标类型选择正确

### 2. 样本量
- 建议每组至少30个样本
- 样本量越大，重随机效果越好
- 但样本量过大可能影响计算速度

### 3. 迭代次数
- 建议设置为100-1000次
- 次数越多，找到更好种子的概率越大
- 但会增加计算时间

### 4. 组别比例
- 总和必须等于100%
- 常见配置：对照组50%，实验组50%
- 也支持多组实验：对照组40%，实验组A 30%，实验组B 30%

## 注意事项

1. **数据质量**: 确保数据没有缺失值或异常值
2. **指标类型**: 正确选择指标类型，避免使用错误的检验方法
3. **样本量**: 确保每组有足够的样本进行统计检验
4. **计算时间**: 迭代次数越多，计算时间越长
5. **结果解释**: T统计量小不代表没有差异，只是组间不平衡最小

## 故障排除

### 常见问题
1. **数据上传失败**: 检查CSV格式是否正确
2. **指标类型错误**: 确认指标数据格式与选择的类型匹配
3. **计算失败**: 检查数据是否包含缺失值或非数值
4. **结果异常**: 检查样本量是否足够

### 调试步骤
1. 检查数据预览是否正确
2. 确认指标列选择正确
3. 验证指标类型设置
4. 查看浏览器控制台错误信息
5. 检查后端服务是否正常运行

## 技术原理

### SeedFinder算法
1. 生成多个随机种子
2. 对每个种子进行分组
3. 计算所有指标的T统计量
4. 找到T统计量最小的种子
5. 使用最佳种子进行最终分组

### 统计检验方法
- **均值**: Welch's t-test，适用于连续数据
- **比例**: Z检验，适用于二分类数据
- **比率**: Delta方法检验，适用于需要计算比率的指标

通过这种方式，重随机模块能够为AB测试提供最公平的分组方案，确保实验结果的可靠性。 